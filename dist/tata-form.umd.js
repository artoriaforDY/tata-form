(function(u,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","vue","element-plus"],n):(u=typeof globalThis<"u"?globalThis:u||self,n(u.TataForm={},u.Vue,u.ElementPlus))})(this,function(u,n,i){"use strict";const c=e=>({row:i.ElRow,col:i.ElCol,form:i.ElForm,"form-item":i.ElFormItem,input:i.ElInput,"input-number":i.ElInputNumber,autocomplete:i.ElAutocomplete,select:i.ElSelect,option:i.ElOption,"select-v2":i.ElSelectV2,"tree-select":i.ElTreeSelect,"checkbox-group":i.ElCheckboxGroup,checkbox:i.ElCheckbox,"radio-group":i.ElRadioGroup,radio:i.ElRadio,"radio-button":i.ElRadioButton,date:i.ElDatePicker,time:i.ElTimePicker,"time-select":i.ElTimeSelect,cascader:i.ElCascader,slider:i.ElSlider,switch:i.ElSwitch})[e],w=n.defineComponent({name:"TataForm",props:{formList:{type:Array,required:!0},options:{type:Object,default:()=>{}},grid:{type:[Array,Number]},labelWidth:{type:[String,Number],default:100},contentWidth:{type:[Number,String],default:"100%"},clearable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},data(){return{form:this.initForm(),refObj:{}}},computed:{rules(){let e={};return this.formList.forEach(r=>{this.isRequired(r)&&(e[r.key]=r.rule)}),e}},methods:{initForm(e){if(!Array.isArray(this.formList))return console.error("formList must be an array"),{};let r={},s={input:"","input-number":0,autocomplete:"",select:null,"select-v2":null,"tree-select":null,"checkbox-group":[],"radio-group":"",date:"",time:"","time-select":"",cascader:[],slider:0,switch:!1};return this.formList.forEach(o=>{var l,h,d,a,p;let t=o.defaultValue?o.defaultValue:s[o.type];if(o.type==="date"?(l=o.props)!=null&&l.type&&((d=(h=o.props)==null?void 0:h.type)==null?void 0:d.indexOf("range"))!==-1&&(t=[]):o.type==="time"&&(p=(a=o.props)==null?void 0:a.type)!=null&&p.isRange&&(t=["",""]),o.key){let y=typeof o.disabled=="function"?o.disabled(this.form,o):o.disabled;r[o.key]=e&&y?r[o.key]:t}}),r},generateTag({item:e,tagName:r,tagType:s,options:o}){let t=typeof e.disabled=="function"?e.disabled(this.form,o):e.disabled,l={"model-value":this.form[e.key],clearable:!0,...e.props||{},disabled:this.disabled||t},h=e.attrs||{},d=e.on||{},a={...l,...h,key:e.key,style:{},"onUpdate:modelValue":f=>{this.form[e.key]=f}};e.width&&(a.style.width=typeof e.width=="string"?e.width:e.width+"px"),o&&(s==="tree-select"?a.data=o:["checkbox-group","radio-group","select"].includes(s)||(a.options=o));const y=(f,g)=>{g.ref&&(this.refObj[g.ref]=this.$refs[g.ref]),this.form[g.key]=f,this.emitInput(f,g,this.refObj)};s==="input"?a.onInput=f=>y(f,e):a.onChange=f=>y(f,e);const b=f=>(...g)=>{f(...g,e,this.form)},F=f=>"on"+f.charAt(0).toUpperCase()+f.slice(1);for(let f in d)a[F(f)]=b(d[f]);return e.hasOwnProperty("ref")&&(a.ref=e.ref),["select-v2","tree-select","cascader"].includes(e.type)?n.h(r,a):n.h(r,a,()=>o)},formatDateValue(e,r){var s,o,t,l;return r.type==="date"?((o=(s=r.props)==null?void 0:s.type)==null?void 0:o.indexOf("range"))!==-1?["",""]:e:r.type==="time"?(l=(t=r.props)==null?void 0:t.type)!=null&&l.isRange?e:["",""]:e},emitInput(e,r,s){typeof r.onInput=="function"&&r.onInput(e,r,this.form,s)},async submit(){const e=await this.$refs.form.validate();this.$emit("submitTataForm",this.getForm(),e,this.$refs)},reset(e){this.clear(),this.form=this.initForm(e),this.$refs.form.resetFields()},clear(e){this.$refs.form.clearValidate&&this.$refs.form.clearValidate(e||void 0)},getFormBykey(e){return this.form[e]},getForm(){return{...this.form}},setForm(e){for(let r in e)this.form[r]=e[r]},async validate(){return await this.$refs.form.validate()},validateField(e,r){return this.$refs.form.validateField(e,r)},renderFormList(e){const r=this.grid;return typeof r=="number"?this.getFormListByNumber(e):Array.isArray(r)?this.getFormListByArray(e):this.getFormList(e)},getFormList(e){return this.formList.map(r=>this.getFormItem(r,this.getContent(r)))},getFormListByNumber(e){let r=[],s=~~Math.abs(this.grid);s<1&&(s=1);let o=this.formList.filter(t=>{let l=typeof t.isShow=="function"?t.isShow(this.form,t):t.hasOwnProperty("isShow")?!!t.isShow:!0,h=typeof t.hasRow=="function"?t.hasRow(this.form,t):t.hasOwnProperty("hasRow")?!!t.hasRow:!0;return!(!l&&!h)});for(let t=0;t<o.length;t+=s){let l=[];for(let d=0;d<s&&t+d<o.length;d++){let a=o[t+d];if(!a)break;let p=this.getFormItem(a,this.getContent(a)),y=e(c("col"),{span:24/s},[p]);l.push(y)}let h=this.getRow(l);r.push(h)}return r},getFormListByArray(e){let r=[],s=0,o=this.formList.filter(t=>{let l=typeof t.isShow=="function"?t.isShow(this.form,t):t.hasOwnProperty("isShow")?!!t.isShow:!0,h=typeof t.hasRow=="function"?t.hasRow(this.form,t):t.hasOwnProperty("hasRow")?!!t.hasRow:!0;return!(!l&&!h)});for(let t=0;t<o.length;){let l=[],h=this.grid[s];for(let a=0;a<h;a++){let p=o[t+a];if(!p)break;let y=this.getFormItem(p,this.getContent(p)),b=e(c("col"),{span:24/h},[y]);l.push(b)}let d=this.getRow(l);r.push(d),s+=1,t+=h}return r},getRow(e){return n.h(c("row"),e)},getContent(e){let r="";return typeof e.renderContent=="function"?r=e.renderContent(n.h,e,this.form):r=!e.key&&!e.type?"":this.renderTagByName(e),r},getFormItem(e,r){if(e.isShow===!1||typeof e.isShow=="function"&&e.isShow(this.form,e)===!1)return null;if(typeof e.render=="function")return e.render(n.h,e,this.form);{let s=e.itemWidth||this.contentWidth,o={prop:e.key,label:e.title,required:!!this.isRequired(e),style:{width:typeof s=="string"?s:s+"px"},...e.settings},t={default:()=>[r]};return e.renderTitle&&(t.label=()=>this.renderTitle(n.h,e,this.form)),n.h(c("form-item"),o,t)}},isRequired(e){return e.rule?Array.isArray(e.rule)?e.rule.some(r=>r.required):e.rule.required:!1},renderTitle(e,r){return r.renderTitle?typeof r.renderTitle=="function"?r.renderTitle(e,r,this.form):r.title:r.title?r.title:""},renderTagByName(e){const r=["select","checkbox-group","radio-group"],s=["select-v2","tree-select","cascader"];let o={item:e,tagType:e.type,tagName:c(e.type)};return r.includes(e.type)?o.options=this.renderTagChildren(e):s.includes(e.type)&&(o.options=e.options||[]),this.generateTag(o)},renderTagChildren(e){let r=o=>({label:o.text,value:o.value,disabled:o.disabled}),s=[];switch(e.type){case"select":s=e.options.map(t=>n.h(c("option"),{...r(t)},typeof e.renderOption=="function"?[e.renderOption(n.h,t,e)]:""));break;case"checkbox-group":s=e.options.map(t=>n.h(c("checkbox"),{...r(t)},typeof e.renderOption=="function"?[e.renderOption(n.h,t,e)]:""));break;case"radio-group":const o=e.props||{};s=e.options.map(t=>n.h(c(o!=null&&o.radioButton?"radio-button":"radio"),{...r(t)},typeof e.renderOption=="function"?[e.renderOption(n.h,t,e)]:""));break}return s}},render(){return n.h(i.ElForm,{model:this.form,"label-width":typeof this.labelWidth=="string"?this.labelWidth:this.labelWidth+"px",...this.options,rules:this.rules,ref:"form"},()=>{var e,r;return[this.renderFormList(n.h),(r=(e=this.$slots).default)==null?void 0:r.call(e)]})}});u.TataForm=w,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
